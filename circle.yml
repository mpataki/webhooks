test:
  override:
    - echo 'no tests'

deployment:
  bump_and_tag_version:
    branch: release
    commands:
      - git fetch --prune --tags
      - git tag
      - git config user.email "fake@email.com"
      - git config user.name "Webhooks Version Bot"
      - ./deploy_scripts/bump.sh patch
      - git add VERSION
      - git commit -m 'version bump [skip ci]'
      - VERSION=$(cat VERSION)
      - git tag -d $VERSION || echo ''
      - git tag -a $VERSION -m 'version bump'
      - git push origin :refs/tags/$VERSION
      - git push origin release
      - git fetch origin master
      - git checkout master || git checkout -t origin/master
      - git merge release
      - git push origin master
